## react+ts+zustandçš„mvvmå®ç°çš„æœ€ä½³ç›®å½•è§„èŒƒï¼š

```plaintext
src/
â”œâ”€â”€ view/                    # è§†å›¾å±‚
â”‚   â”œâ”€â”€ components/          # æ— çŠ¶æ€ UI ç»„ä»¶
    â”‚   â”œâ”€â”€ ui/                  # shadcn/ui åŸå­ç»„ä»¶
    â”‚   â”œâ”€â”€ common/              # å…¨å±€é€šç”¨ä¸šåŠ¡ç»„ä»¶
    â”‚   â”œâ”€â”€ providers/           # å…¨å±€ Context Providers
â”‚   â”œâ”€â”€ pages/               # é¡µé¢éª¨æ¶
â”‚   â””â”€â”€ features/            # æŒ‰åŠŸèƒ½æ¨¡å—æ‹†åˆ†
â”‚       â””â”€â”€ [FeatureName]/
â”‚           â”œâ”€â”€ components/  # åŠŸèƒ½ä¸“ç”¨ç»„ä»¶
â”‚           â””â”€â”€ hooks/       # ViewModel å±‚
â”‚
â”œâ”€â”€ model/                   # æ¨¡å‹å±‚
â”‚   â”œâ”€â”€ stores/              # Zustand å…¨å±€çŠ¶æ€
â”‚   â”œâ”€â”€ services/            # ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ events/              # äº‹ä»¶ç³»ç»Ÿï¼ˆå¯é€‰ï¼‰
â”‚   â””â”€â”€ entities/            # å®ä½“ç±»å‹å®šä¹‰
â”‚
â”œâ”€â”€ infra/                   # åŸºç¡€è®¾æ–½å±‚
â”‚   â”œâ”€â”€ api/                 # åç«¯ API äº¤äº’
â”‚   â””â”€â”€ dao/                 # æœ¬åœ°æ•°æ®åº“è®¿é—®
â”‚
â””â”€â”€ common/                  # å…¬å…±æ¨¡å—
    â”œâ”€â”€ lib/                 # ç¬¬ä¸‰æ–¹åº“å°è£…
    â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
```

## ç»“åˆDIä¹‹åçš„æ¶æ„å›¾ï¼š
  
```mermaid
graph TD
    subgraph ViewLayer["View Layer (React / Functional)"]
        Page["Page é¡µé¢éª¨æ¶"]
        Comp["Component ç»„ä»¶"]
        Hook["Hook / ViewModel (èƒ¶æ°´å±‚)"]
    end

    subgraph ModelLayer["Model Layer (Class / Logic)"]
        Service["Service ä¸šåŠ¡é€»è¾‘ (Singleton)"]
        Entity["Entity å®ä½“å®šä¹‰"]
        Store["Zustand Store (Global State)"]
    end

    subgraph InfraLayer["Infra Layer (Class / IO)"]
        API["API Client (Singleton)"]
        DAO["DAO / LocalDB (Singleton)"]
    end

    Comp -->|è°ƒç”¨| Hook
    Hook -->|1. Resolve| Service
    Hook -->|2. Subscribe| Store
    Service -->|Inject| API
    Service -->|Inject| DAO
    Service -->|Action| Store
    API --> Backend
```
å…¸å‹çš„ï¼š

- **view** â†’ è¡¨ç°å±‚ï¼ˆReactï¼‰
    
- **model** â†’ ä¸šåŠ¡å±‚ï¼ˆDomain + Applicationï¼‰
    
- **infra** â†’ åŸºç¡€è®¾æ–½å±‚ï¼ˆAPIã€DBã€Storageï¼‰
    
- **common** â†’ å…¬å…±å·¥å…·
    

## å¦‚ä½•ç®¡ç†ç±»çš„ç”Ÿå‘½å‘¨æœŸ

ç”¨ DI æ¥åš class ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œä¼šè®© model/service å’Œ infra å®Œæ•´åˆ†ç¦»ï¼Œè¾¾åˆ°æœ€ä¼˜èšåˆã€‚

---

### ğŸ¯ ä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨ tsyringeï¼ˆDIï¼‰ï¼Ÿ

ä½ çš„æ¶æ„é‡Œ **é€‚åˆæ³¨å…¥çš„åªæœ‰ â€œClass å®ä¾‹â€**ï¼š

|å±‚|æ˜¯å¦ç”¨ tsyringe æ³¨å…¥ï¼Ÿ|ç†ç”±|
|---|---|---|
|view (React Component / ViewModel Hook)|âŒ ä¸ä½¿ç”¨|React hook ç®¡ç†çŠ¶æ€ï¼Œä¸é€‚åˆ class æ³¨å…¥|
|model/store (Zustand Store)|âŒ ä¸é€‚åˆ DI|Store æ˜¯å‡½æ•°åˆ›å»ºçš„ï¼Œä¸æ˜¯ class|
|**model/service**|âœ” **å¼ºçƒˆæ¨è**|è¦ç®¡ç†ä¸šåŠ¡é€»è¾‘ç”Ÿå‘½å‘¨æœŸ|
|model/event|âœ” è§†æƒ…å†µ|EventBus ç±»å¾ˆé€‚åˆå•ä¾‹|
|model/entity|âŒ ä¸å¿…|å®ä½“ä¸€èˆ¬åªæ˜¯ç±»å‹å®šä¹‰æˆ–æ™®é€šå¯¹è±¡|
|**infra/api**|âœ” **å¿…é¡» DI**|ä½œä¸ºå…¨å±€å•ä¾‹ï¼Œé¿å…é‡å¤å®ä¾‹åŒ–|
|**infra/dao**|âœ” **å¿…é¡» DI**|IndexedDB/sql.js/localstorage å®¢æˆ·ç«¯éƒ½åº”å•ä¾‹|
|common/lib/util|âŒ ä¸ä½¿ç”¨|çº¯å‡½æ•°æ— éœ€ DI|

---

### ğŸ§± æœ€æ¨èçš„ç”Ÿå‘½å‘¨æœŸ

```
(App å¯åŠ¨)
  â”‚
  â–¼
Infra (api/dao) â€”â€”â€”> å•ä¾‹
  â”‚
  â–¼
Model (service/event) â€”â€”â€”> å•ä¾‹
  â”‚
  â–¼
ViewModelï¼ˆhookï¼‰ â€”â€”â€”> é¡µé¢çº§ç”Ÿå‘½å‘¨æœŸ
  â”‚
  â–¼
Viewï¼ˆç»„ä»¶ï¼‰ â€”â€”â€”> React æ§åˆ¶
```

**serviceã€apiã€dao å…¨éƒ¨äº¤ç»™ tsyringe ç»Ÿä¸€ç®¡ç† â†’ æœ€ä½³å®è·µ**