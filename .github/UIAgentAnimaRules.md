# 微交互动效设计规范

> **本文档定位**：动效设计原则、哲学和标准  
> **实现细节**：见 `copilot-shadcn-anima-style.md`  
> **基础规范**：见 `UIAgentRules.md`

---

## 🎯 微交互定义

**什么是微交互**：围绕单一任务的精致反馈时刻

**核心价值**：
- 🎨 **建立情感连接** - 让用户感受到产品的"呼吸"
- 🔍 **提供即时反馈** - 告知用户操作已被感知
- 🎭 **强化品牌个性** - 通过细节展现产品气质
- 🧭 **引导用户注意** - 自然地引导视线和交互流程

**设计目标**：
- 自然流畅，符合物理直觉
- 细腻精致，体现专业品质
- 性能优先，不影响核心体验
- 克制使用，避免过度装饰

---

## 🌊 Framer Motion 设计哲学

### 核心原则

1. **物理真实感（Spring Physics）**
   - 优先使用 `spring` 类型而非固定 `duration`
   - 弹性动画比线性动画更自然
   - 符合用户对现实世界的物理预期

2. **优雅编排（Orchestration）**
   - 使用 `stagger children` 创造层次感
   - 通过 `variants` 复用动画逻辑
   - 让多个元素协调配合，而非各自为战

3. **声明式设计（Declarative）**
   - 描述"是什么"而非"怎么做"
   - 用状态驱动动画，而非命令式控制
   - 让代码更易读、更易维护

4. **性能优先（Performance）**
   - 只动画 `transform` 和 `opacity`（GPU 加速）
   - 避免动画 `width`、`height`、`margin` 等（触发 layout）
   - 使用 `will-change` 提前告知浏览器优化

5. **响应式动效（Responsive）**
   - 尊重用户的 `prefers-reduced-motion` 设置
   - 在低性能设备上降级动效
   - 确保无障碍访问

---

## ⚡ 时长标准与缓动

### 时长分级

| 时长 | 适用场景 | 用户感知 |
|------|----------|----------|
| **150ms** | 按钮反馈、开关切换 | 瞬间响应，无等待感 |
| **200ms** | 悬停效果、边框变化 | 快速过渡，流畅自然 |
| **300ms** | 卡片展开、菜单显示 | 平滑展开，舒适观感 |
| **500ms** | 页面过渡、复杂动画 | 完整动效，戏剧性强 |

### 缓动曲线原则

| 缓动类型 | 特点 | 适用场景 |
|----------|------|----------|
| **Spring** | 物理弹性，自然流畅 | 大多数交互场景（推荐） |
| **Ease Out** | 快速启动，缓慢停止 | 元素进入视口 |
| **Ease In** | 缓慢启动，快速停止 | 元素离开视口 |
| **Linear** | 匀速运动 | 无限循环动画（如加载器） |

**设计建议**：
- ✅ 优先使用 spring 弹性动画
- ✅ 快速交互用高 stiffness（400+）
- ✅ 平滑过渡用低 stiffness（100-200）
- ❌ 避免使用 ease-in-out（感觉迟钝）

---

## � 微交互分类与原则

### 1. 反馈型动效（Feedback）

**目的**：告知用户"我看到了你的操作"

**适用场景**：
- 按钮点击
- 开关切换
- 复选框勾选
- 表单提交

**设计原则**：
- ⚡ 即时响应（150ms 内）
- 🎯 明确清晰（缩放、颜色变化）
- 🔄 可逆性（可撤销操作需有退出动画）

### 2. 引导型动效（Feed-forward）

**目的**：告诉用户"接下来会发生什么"

**适用场景**：
- 悬停预览
- 拖拽提示
- 手势引导
- 加载状态

**设计原则**：
- 👀 吸引注意（明显但不过度）
- 🧭 方向明确（提示下一步操作）
- 🎭 增强预期（让用户心中有数）

### 3. 叙事型动效（Narrative）

**目的**：通过动效讲述故事，增强情感连接

**适用场景**：
- 页面过渡
- 空状态插图
- 成功/失败动画
- 品牌彩蛋

**设计原则**：
- 🎬 有情节感（开始、发展、结束）
- 🎨 风格一致（符合品牌调性）
- ⚖️ 适度克制（不喧宾夺主）

### 4. 装饰型动效（Decorative）

**目的**：纯粹的视觉美化，增强品牌个性

**适用场景**：
- 背景粒子
- 光标跟随
- 视差滚动
- 节日彩蛋

**设计原则**：
- 💎 精致细腻（体现品牌品质）
- 🎭 可选择性（可关闭或降级）
- 🚀 不影响性能（使用 GPU 加速）

---

## 🎯 Sider.ai 动效特色

### 品牌动效调性

**关键词**：
- 🌊 **流畅** - Spring 弹性，无突兀感
- ✨ **精致** - 细节丰富，多属性组合
- 🎨 **现代** - 边框变色优于阴影
- ⚡ **快速** - 150-300ms，不拖沓
- 🎭 **克制** - 恰到好处，不过度

### 标志性动效

1. **按钮微交互**
   - 悬停：上浮 2px + 放大 1.02
   - 点击：缩小 0.98
   - 弹性：spring 动画（stiffness: 400）

2. **卡片悬停**
   - 上浮 8px（较大位移）
   - 边框变色（灰 → 紫）
   - 无阴影（更现代简洁）

3. **Tab 切换**
   - 胶囊滑动（layoutId）
   - 深色背景跟随
   - 平滑过渡（spring）

4. **图标交互**
   - Group hover 联动
   - 图标容器颜色变化
   - 箭头位移动画

5. **进度反馈**
   - 渐变色进度条
   - 数值平滑增长
   - 完成状态庆祝动画

---

## 🎬 交互场景最佳实践

### 按钮交互

**标准模式**：
- 悬停：轻微放大 + 上浮
- 点击：缩小反馈
- 加载：旋转图标 + 文字淡出

**禁忌**：
- ❌ 过度放大（超过 1.1）
- ❌ 过度位移（超过 5px）
- ❌ 过慢动画（超过 300ms）

### 卡片交互

**标准模式**：
- 入场：滚动触发淡入
- 悬停：上浮 + 边框高亮
- 点击：整体缩小或局部展开

**禁忌**：
- ❌ 悬停添加大阴影（过时设计）
- ❌ 入场动画过于复杂
- ❌ 多个卡片同时触发动画

### 表单交互

**标准模式**：
- 聚焦：边框变色 + 外发光
- 输入：浮动标签上移
- 错误：抖动 + 红色边框

**禁忌**：
- ❌ 聚焦时过度放大输入框
- ❌ 错误提示突然出现（需淡入）
- ❌ 验证成功动画过于夸张

### Modal 交互

**标准模式**：
- 打开：遮罩淡入 + 内容缩放淡入
- 关闭：退出动画与进入对称
- 内容：stagger children 渐入

**禁忌**：
- ❌ 从屏幕外滑入（过时设计）
- ❌ 关闭无动画（体验突兀）
- ❌ 遮罩层无过渡

### 列表交互

**标准模式**：
- 加载：骨架屏 → stagger 渐入
- 悬停：背景色变化 + 箭头位移
- 删除：滑出 + 其他项位移填补

**禁忌**：
- ❌ 所有项同时出现（无层次感）
- ❌ 删除瞬间消失（需滑出动画）
- ❌ 悬停过度复杂的动画

---

## 🌓 深色模式动效

### 主题切换原则

**平滑过渡**：
- 所有颜色变量使用 `transition`
- 过渡时长统一 200ms
- 使用 `ease` 缓动

**图标动画**：
- 太阳/月亮旋转切换
- AnimatePresence 处理退出
- 按钮点击缩放反馈

**禁忌**：
- ❌ 主题切换无过渡（闪烁）
- ❌ 部分元素未跟随主题
- ❌ 动画过慢（超过 300ms）

---

## 📱 移动端动效优化

### 触摸交互

**标准模式**：
- 触摸：0.98 缩放反馈
- 长按：渐进式放大（从 1 到 1.05）
- 滑动：跟随手指位移

**性能优化**：
- 禁用默认触摸高亮
- 使用 transform 而非 position
- 减少动画复杂度

### 响应式动效

**适配策略**：
- 小屏：简化动画，减少位移
- 低性能：关闭装饰型动效
- 慢速网络：优先加载内容，动效降级

---

## ♿ 无障碍与性能

### 尊重用户偏好

```jsx
// 检测用户动画偏好
const shouldReduceMotion = useReducedMotion()

// 根据偏好调整动画
<motion.div
  animate={shouldReduceMotion ? {} : { scale: 1.1 }}
  transition={shouldReduceMotion ? { duration: 0 } : { duration: 0.3 }}
/>
```

### 性能最佳实践

**推荐动画属性**（GPU 加速）：
- ✅ `transform` (translate, scale, rotate)
- ✅ `opacity`

**避免动画属性**（触发 layout）：
- ❌ `width` / `height`
- ❌ `top` / `left` / `margin`
- ❌ `padding` / `border-width`

**优化技巧**：
- 使用 `will-change` 提前通知浏览器
- 避免在低性能设备上使用复杂动画
- 使用 `layoutId` 实现 FLIP 动画

---

## ✅ 动效设计检查清单

### 基础规范
- [ ] 动画时长 150-300ms（常规交互）
- [ ] 优先使用 spring 弹性动画
- [ ] 按钮有悬停和点击动效
- [ ] 卡片有入场和悬停动效
- [ ] Modal 有进入和退出动画

### 进阶细节
- [ ] 列表使用 stagger children 渐入
- [ ] 表单输入有聚焦反馈
- [ ] 加载状态有明确动画
- [ ] 错误状态有抖动提示
- [ ] 成功状态有庆祝动画

### 性能与无障碍
- [ ] 只动画 transform 和 opacity
- [ ] 使用 AnimatePresence 处理退出
- [ ] 尊重 prefers-reduced-motion
- [ ] 避免动画 width/height
- [ ] 低性能设备降级动效

### Sider.ai 风格
- [ ] 按钮悬停上浮 2px + 放大 1.02
- [ ] 卡片悬停上浮 8px
- [ ] 边框变色而非添加阴影
- [ ] Tab 使用 layoutId 平滑切换
- [ ] 图标容器响应 group hover
- [ ] 进度条使用渐变色
- [ ] Toast 从顶部滑入
- [ ] 徽章有脉冲动画

---

## 📚 参考资源

**设计灵感**：
- [motion.dev](https://motion.dev) - Framer Motion 官方示例
- [uiverse.io](https://uiverse.io) - 开源微交互库
- [Dribbble](https://dribbble.com) - 微交互设计作品

**技术文档**：
- [Framer Motion 官方文档](https://www.framer.com/motion/)
- [shadcn/ui 组件库](https://ui.shadcn.com/)
- [Web Animations API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Animations_API)

**实现细节**：
- 完整代码示例见 `copilot-shadcn-anima-style.md`

